{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport axios from 'axios';\nexport default {\n  __name: 'ChatView',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const messages = ref([]);\n    const inputMessage = ref('');\n    const showError = ref(false);\n    const sendMessage = async () => {\n      if (inputMessage.value.trim() === '') {\n        showError.value = true;\n        return;\n      }\n      messages.value.push({\n        text: inputMessage.value,\n        sender: 'user'\n      });\n      try {\n        const response = await axios.post('http://localhost:9090/chat', inputMessage.value, {\n          headers: {\n            'Content-Type': 'text/plain' // 明确指定请求类型\n          }\n        });\n        // 处理可能的嵌套响应\n        const result = typeof response.data === 'string' ? response.data : response.data.data?.result;\n        messages.value.push({\n          text: result || '无返回内容',\n          sender: 'llm'\n        });\n      } catch (error) {\n        ElMessage.error(`请求失败: ${error.response?.data?.error || error.message}`);\n      }\n      inputMessage.value = '';\n      showError.value = false;\n    };\n    const __returned__ = {\n      messages,\n      inputMessage,\n      showError,\n      sendMessage,\n      ref,\n      get ElMessage() {\n        return ElMessage;\n      },\n      get axios() {\n        return axios;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","ElMessage","axios","messages","inputMessage","showError","sendMessage","value","trim","push","text","sender","response","post","headers","result","data","error","message"],"sources":["C:/Users/哈振宇/Desktop/软件工程/springboot+vue框架/demo/vue/src/views/ChatView.vue"],"sourcesContent":["<template>\n  <div>\n    <el-card style=\"width: 80%; margin: 20px auto\">\n      <div style=\"font-size: 30px; text-align: center; margin: 10px auto; color: cornflowerblue\">AI 助手</div>\n      <div class=\"chat-messages\">\n        <div v-for=\"(message, index) in messages\" :key=\"index\" class=\"message\" :class=\"message.sender\">\n          <div class=\"message-content\">\n            {{ message.text }}\n          </div>\n        </div>\n      </div>\n      <el-alert v-if=\"showError\" type=\"error\" :closable=\"false\">消息不能为空！</el-alert>\n      <div class=\"chat-input\">\n        <el-input\n          v-model=\"inputMessage\"\n          placeholder=\"请输入消息\"\n          @keyup.enter=\"sendMessage\"\n          style=\"width: calc(100% - 120px); margin-right: 10px; height: 40px\"\n        />\n        <el-button type=\"primary\" style=\"height: 40px\" @click=\"sendMessage\">发送</el-button>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue';\nimport { ElMessage } from 'element-plus';\nimport axios from 'axios';\n\nconst messages = ref([]);\nconst inputMessage = ref('');\nconst showError = ref(false);\n\nconst sendMessage = async () => {\n  if (inputMessage.value.trim() === '') {\n    showError.value = true;\n    return;\n  }\n  messages.value.push({ text: inputMessage.value, sender: 'user' });\n  try {\n    const response = await axios.post('http://localhost:9090/chat', inputMessage.value, {\n      headers: {\n        'Content-Type': 'text/plain' // 明确指定请求类型\n      }\n    });\n    // 处理可能的嵌套响应\n    const result = typeof response.data === 'string' ? response.data : response.data.data?.result;\n    messages.value.push({ text: result || '无返回内容', sender: 'llm' });\n  } catch (error) {\n    ElMessage.error(`请求失败: ${error.response?.data?.error || error.message}`);\n  }\n  inputMessage.value = '';\n  showError.value = false;\n};\n\n</script>\n\n<style scoped>\n.chat-messages {\n  height: 400px;\n  overflow-y: auto;\n  margin-bottom: 20px;\n}\n\n.message {\n  margin-bottom: 10px;\n}\n\n.message-content {\n  padding: 10px;\n  border-radius: 5px;\n  max-width: 70%;\n}\n\n.user .message-content {\n  background-color: #409eff;\n  color: white;\n  margin-left: auto;\n}\n\n.llm .message-content {\n  background-color: #f0f0f0;\n  color: black;\n  margin-right: auto;\n}\n\n.chat-input {\n  display: flex;\n  align-items: center;\n}\n</style>"],"mappings":";AA0BA,SAASA,GAAG,QAAQ,KAAK;AACzB,SAASC,SAAS,QAAQ,cAAc;AACxC,OAAOC,KAAK,MAAM,OAAO;;;;;;;IAEzB,MAAMC,QAAQ,GAAGH,GAAG,CAAC,EAAE,CAAC;IACxB,MAAMI,YAAY,GAAGJ,GAAG,CAAC,EAAE,CAAC;IAC5B,MAAMK,SAAS,GAAGL,GAAG,CAAC,KAAK,CAAC;IAE5B,MAAMM,WAAW,GAAG,MAAAA,CAAA,KAAY;MAC9B,IAAIF,YAAY,CAACG,KAAK,CAACC,IAAI,CAAC,CAAC,KAAK,EAAE,EAAE;QACpCH,SAAS,CAACE,KAAK,GAAG,IAAI;QACtB;MACF;MACAJ,QAAQ,CAACI,KAAK,CAACE,IAAI,CAAC;QAAEC,IAAI,EAAEN,YAAY,CAACG,KAAK;QAAEI,MAAM,EAAE;MAAO,CAAC,CAAC;MACjE,IAAI;QACF,MAAMC,QAAQ,GAAG,MAAMV,KAAK,CAACW,IAAI,CAAC,4BAA4B,EAAET,YAAY,CAACG,KAAK,EAAE;UAClFO,OAAO,EAAE;YACP,cAAc,EAAE,YAAY,CAAC;UAC/B;QACF,CAAC,CAAC;QACF;QACA,MAAMC,MAAM,GAAG,OAAOH,QAAQ,CAACI,IAAI,KAAK,QAAQ,GAAGJ,QAAQ,CAACI,IAAI,GAAGJ,QAAQ,CAACI,IAAI,CAACA,IAAI,EAAED,MAAM;QAC7FZ,QAAQ,CAACI,KAAK,CAACE,IAAI,CAAC;UAAEC,IAAI,EAAEK,MAAM,IAAI,OAAO;UAAEJ,MAAM,EAAE;QAAM,CAAC,CAAC;MACjE,CAAC,CAAC,OAAOM,KAAK,EAAE;QACdhB,SAAS,CAACgB,KAAK,CAAC,SAASA,KAAK,CAACL,QAAQ,EAAEI,IAAI,EAAEC,KAAK,IAAIA,KAAK,CAACC,OAAO,EAAE,CAAC;MAC1E;MACAd,YAAY,CAACG,KAAK,GAAG,EAAE;MACvBF,SAAS,CAACE,KAAK,GAAG,KAAK;IACzB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}